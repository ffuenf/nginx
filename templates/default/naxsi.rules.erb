# Generated by Chef for node <%= node["fqdn"] %>
# Local modifications will be overwritten.
#
# The naxsi configuration file.
<% if node['nginx']['naxsi']['LearningMode'] %>
LearningMode; #Enables learning mode
<% end  %>
<% if node['nginx']['naxsi']['SecRulesEnabled'] %>
SecRulesEnabled;
<% else  %>
SecRulesDisabled;
<% end  %>
DeniedUrl <%= node['nginx']['naxsi']['DeniedUrl'] %>;

include <%= node['nginx']['naxsi']['tmp_file'] %>;

## check rules
CheckRule "$SQL >= 8" BLOCK;
CheckRule "$RFI >= 8" BLOCK;
CheckRule "$TRAVERSAL >= 4" BLOCK;
CheckRule "$EVADE >= 4" BLOCK;
CheckRule "$XSS >= 8" BLOCK;